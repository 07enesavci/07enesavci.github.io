---
layout: post
title: "Server-Side Request Forgery (SSRF): Nedir, Nasıl Tespit Edilir ve Nasıl Önlenir?"
date: 2025-09-24
tags: [web-security, ssrf, owasp, pentest, cloud-security]
author: "07enesavci"
summary: "SSRF saldırısının tanımı, varyantları, pratik exploit örnekleri (dosya/metadata/SSRF üzerinden pivot), tespit yöntemleri ve kalıcı önleme adımları."
---

# Server-Side Request Forgery (SSRF) — Kapsamlı Rehber

**Uyarı:** Bu yazı eğitim / CTF / izinli penetration testing amaçlıdır. Buradaki teknikleri **sadece yetki verilen ortamlarda** kullan. İzinsiz deneme yasa dışıdır ve etik değildir.

---

## SSFR nedir? (kısa ve net)
**Server-Side Request Forgery (SSRF)**, bir saldırganın uygulamanın kendi sunucusundan (ya da sunucunun ağından) başka bir kaynağa istekte bulunmasını sağladığı zafiyettir. Yani saldırgan istemci tarafından değil, **sunucu aracılığıyla** istek yaptırır ve böylece iç ağ kaynaklarına, metadata servislerine veya başka güvenli sayılan kaynaklara erişebilir.

Basitçe:  
> Kullanıcıya URL/host girme imkânı veren veya uzak kaynakları çeken bir sunucu, gelen değeri yeterince doğrulamıyorsa saldırgan sunucuyu kendisi için istek yapmaya zorlayabilir.

---

## Neden tehlikeli?
- İç ağa erişim (internal services) — DB admin panelleri, yönetim konsolları.  
- Bulut metadata endpoint’lerine erişim (ör. AWS IMDS) → credentials sızması.  
- İç servisleri tarayıp pivot yapılması (lateral movement).  
- İçerik/kimlik doğrulama bypass için redirect zincirleri ile kötüye kullanım.  
- Remote file inclusion veya dosya sistemi etkileşimleri (protokole bağlı).

---

## SSRF Türleri / Varyantlar

1. **Direct SSRF (Reflected):** Kullanıcının verdiği URL doğrudan fetch ediliyorsa.  
2. **Blind SSRF:** Sunucu dışarıya veri döndürmez; ancak sunucunun yaptığı istek dışarıya bir DNS/HTTP çağrısı yaparsa (exfil), bunu dış kaynak üzerinden tespit edebilirsin (Burp Collaborator, DNS log).  
3. **SSRF → Internal pivot:** İç IP aralığı (10.x.x.x, 172.16.x.x, 192.168.x.x, 169.254.169.254 vb.) hedef alınır.  
4. **Gopher/FTP/File scheme abuses:** `gopher://` veya `file://` gibi protokollerle farklı istek türleri tetiklenebilir (özellikle bazı platformlarda).  
5. **URL parsing bypass (encoding tricks):** IPv6, 0xHEX, leading zeros, URL encode, `@` bypass, redirect chains.  
6. **SSRF to cloud metadata:** Örneğin AWS IMDS (`http://169.254.169.254/latest/meta-data/`), GCP metadata, Azure IMDS — bu endpoint’ler kimlik bilgisi sızdırabilir.

---

## Yaygın hedefler / ilgi alanları
- `http://127.0.0.1:`, `http://localhost:`, `http://10.*`, `http://169.254.169.254` (cloud metadata)  
- Internal services: Redis, Elasticsearch, Kibana, Adminpanels (8000/9200/5601 vb.)  
- Kurumsal API’ler, LDAP, etcd, Kubernetes API (`/api/v1/namespaces/...`)  
- Internal-only dashboards (grafana, prometheus, admin ui)

---

## Nasıl tespit edilir? (pentest adımları)

### 1) Keşif
- XML / JSON / form parametrelerinde `url`, `callback`, `next`, `image`, `avatar`, `import`, `fetch`, `download` gibi parametreleri ara.  
- Upload/preview/URL-fetch özellikleri yüksek risklidir.

### 2) Basit test payload'ları
- `http://example.com` → dış isteğin yapılıp yapılmadığını kontrol et.  
- DNS/HTTP callback tabanlı test: kendi kontrolündeki bir domain kullan (`http://your-collab.com/xyz`) ya da Burp Collaborator. Blind SSRF için DNS/HTTP loglarını izle.

### 3) İç ağa yönelik testler
- `http://127.0.0.1:80/`, `http://localhost:5984/`, `http://10.0.0.1:2379/` gibi servisleri dene.  
- Cloud metadata: `http://169.254.169.254/latest/meta-data/` (AWS) test et — BU ÇOK KİRIÇTIR; yalnızca izinli ortamlarda.

### 4) URL parsing bypass teknikleri
- IP encoding: `http://127.0.0.1`, `http://2130706433` (127.0.0.1 as decimal), `http://0x7f.0x0.0x0.0x1`  
- IPv6 kısa yazımı: `http://[::1]/`  
- Leading zeros: `http://0177.0.0.1/`  
- `@` trick: `http://127.0.0.1@attacker.com/` (bazı parserlar hostu farklı parse eder)  
- URL encode host veya port: `%31%32%37%2e%30%2e%30%2e%31` vb.

### 5) Protokol abuse
- `gopher://` ile arbitrary TCP payload göndermek (ör. Redis commands) — bazı uygulamalarda `gopher://127.0.0.1:6379/_*` kullanılarak redis komutu çalıştırılabiliyor.  
- `file://` ile local dosya okuma (bazı bileşenler destekliyorsa).  

---

## Pratik Exploit Örnekleri (Eğitim amaçlı)

### 1) Basit reflected SSRF
Kullanıcı girdisi: `url` parametresi.  
İstek:
