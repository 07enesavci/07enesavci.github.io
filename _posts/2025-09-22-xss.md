---
layout: post
title: "XSS (Cross-Site Scripting): Türleri, Tespit ve Korunma"
date: 2025-09-22
tags: [web-security, xss, pentest, webapp]
author: "07enesavci"
reading_time: true
summary: "XSS nedir, ana türleri, basit tespit yaklaşımları ve etkin korunma yöntemleri — kısa ve uygulanabilir rehber."
---

# XSS (Cross-Site Scripting): Türleri, Tespit ve Korunma

**Cross-Site Scripting (XSS)**, bir web uygulamasının kullanıcıya döndürdüğü içerikte kötü amaçlı script kodunun çalışmasına izin veren bir zafiyettir. XSS sayesinde saldırganlar oturum çalma, içerik manipülasyonu, phishing, veya kullanıcı etkileşimlerini kötüye kullanma gibi eylemler gerçekleştirebilir.

> **Uyarı:** Bu yazı eğitim/CTF/izinli pentest amaçlıdır. Izinsiz test veya saldırı yasa dışıdır.

---

## İçerik
1. [XSS Nedir?](#1-xss-nedir)  
2. [Ana XSS Türleri (Kısa)](#2-ana-xss-türleri-kısa)  
3. [Kısa Tespit Yaklaşımları](#3-kısa-tespit-yaklaşımları)  
4. [Pratik Korunma Önerileri](#4-pratik-korunma-önerileri)  
5. [Ek Güvenlik Katmanları (CSP, HttpOnly, SameSite)](#5-ek-güvenlik-katmanları-csp-httponly-samesite)  
6. [Test Araçları ve Otomasyon](#6-test-araçları-ve-otomasyon)  
7. [Raporlama & Etik](#7-raporlama--etik)  
8. [Kısa Özet](#8-kısa-özet)  
9. [Kaynaklar](#9-kaynaklar)

---

## 1) XSS Nedir?
XSS, kullanıcıya gönderilen HTML/JS çıktısına saldırgan kontrollü içerik enjekte edilmesiyle ortaya çıkar. Saldırganın amacı, hedef tarayıcıda kendi JavaScript kodunu çalıştırmaktır. Sonuçlar; çalınmış oturum belirteçleri, istemci tarafı yönlendirme, sahte formlar veya kötü amaçlı içerik sunma olabilir.

---

## 2) Ana XSS Türleri (Kısa)

- **Reflected (Yansıtılan) XSS**: Zararlı payload, istekte gönderilir (query param, form) ve sunucu aynı isteğin yanıtında doğrudan yansıtır. Genelde link tabanlı phishing senaryolarında görülür.  
- **Stored (Persisted) XSS**: Zararlı içerik veritabanına, yorum/örnek alanlarına veya profil alanlarına kaydedilir ve daha sonra birçok kullanıcıya servis edilir — etkisi geniştir.  
- **DOM-based XSS**: Tüm saldırı istemci tarafında, JavaScript’in DOM’u hatalı kullanmasından doğar. Sunucu tarafında herhangi bir değişiklik olmayabilir; payload doğrudan tarayıcıda üretilir veya işlem görür.

---

## 3) Kısa Tespit Yaklaşımları
- Girdilere basit script testleri ekle (ör. `<script>alert(1)</script>`) ve çıktıda gözle.  
- HTML bağlamlarını (attribute, element, JS context, URL, CSS) kontrol et — farklı bağlamlar farklı escaping gerektirir.  
- DOM XSS için devtools console ve DOM inspector ile client-side kodu incele.  
- Otomatik tarayıcılarla tarama yap (ancak false-positive olur; manuel doğrulama şart).

---

## 4) Pratik Korunma Önerileri
- **Output Encoding / Escaping**: Her çıktıyı bağlama uygun şekilde kaçır (HTML escape, attribute escape, JS string escape, URL encode). Bu en temel ve kritik adımdır.  
- **Use Safe Templating**: Modern frameworklerin (React, Vue, Angular) template binding’leri varsayılan olarak escaping yapar — raw HTML kullanımından kaçın.  
- **Sanitize untrusted HTML**: Kullanıcıya HTML izin veriyorsan güvenilir bir sanitizer (ör. DOMPurify) kullan; kendi sanitizer’ını yazma.  
- **Validate Input (white-list)**: Girdi doğrulama yardımcıdır ama tek başına yeterli değildir; öncelik output escaping olmalı.  
- **Reduce attack surface**: Kullanıcı girdisini doğrudan `innerHTML`/`document.write` gibi API’lere göndermeyin.

---

## 5) Ek Güvenlik Katmanları (CSP, HttpOnly, SameSite)
- **Content Security Policy (CSP)**: Inline script ve dış kaynakları sınırlayarak XSS etkisini azaltır. `script-src 'self'` ve nonce/hashes ile inline kodu engelle.  
- **HttpOnly cookie**: Oturum çalma amaçlı JS erişimini engeller (çerezleri JS ile okuyamaz).  
- **SameSite cookie**: CSRF etkilerini azaltır; XSS doğrudan engellemez ama riskleri kademeli azaltır.  
Bu katmanlar birincil koruma değildir — ama başka önlemlerin yanında güçlü ek savunma sağlar.

---

## 6) Test Araçları ve Otomasyon
- **Burp Suite** (manual + scanner), **OWASP ZAP** (otomatik tarama) — başlangıç için.  
- **DOM XSS scanner** ve browser devtools kullanımı (live DOM inspection).  
- CI/CD’de statik analiz & dependency scanning (XSS ile ilişkili kütüphane kullanımını kontrol et).  
- Otomatik tarama sonrası **manuel doğrulama** şarttır — otomatik araçlar false-positive üretebilir.

---

## 7) Raporlama & Etik
- Bulduğun XSS zafiyetini PoC ile göster ama destructive olmamasına dikkat et.  
- Etki: hedef kullanıcı sayısı, çerez/kimlik verisi erişimi ve potansiyel müşteri zararını belirt.  
- Responsible disclosure — vendor/ekip ile iletişim kur, gerekli süreyi tanı.

---

## 8) Kısa Özet
XSS, istemci tarafında kod çalıştırılmasına izin veren kritik bir zafiyettir. Birincil savunma: **bağlama uygun escaping (output encoding)**, güvenli templating ve gerekiyorsa sanitization. CSP + cookie ayarları ek savunma sağlar. Otomatik tarama faydalıdır ama manuel doğrulama olmadan raporlama yapmayın.

---

## 9) Kaynaklar
- OWASP XSS (Cheat Sheet)  
- DOMPurify dokümantasyonu  
- Burp Suite & OWASP ZAP dokümanları

---
